<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#4c0004">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="MP Planner">
  <title>Mourning Person — Planner</title>
  <link rel="manifest" href="manifest.json">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@600;700;800&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>

  <!-- Login screen -->
  <div id="login-screen" class="login-screen">
    <div class="login-content">
      <img src="header-logo.png" alt="Mourning Person" class="login-logo">
      <h1 class="login-title">Editorial Planner</h1>
      <p class="login-sub">Your private space to plan, write, and grow.</p>
      <button id="login-btn" class="btn-login">
        <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
          <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
          <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
          <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
          <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
        </svg>
        Sign in with Google
      </button>
    </div>
  </div>

  <!-- App -->
  <div id="app-content" class="app-content" style="display: none;">

    <header class="main-header">
      <div class="header-inner">
        <div class="header-brand">
          <img src="header-logo.png" alt="Mourning Person" class="header-logo">
          <span class="header-subtitle">Editorial Planner</span>
        </div>
        <div id="user-info" class="user-info">
          <img id="user-avatar" class="user-avatar" src="" alt="">
          <button id="sign-out-btn" class="btn-sign-out">Sign out</button>
        </div>
      </div>
      <nav class="main-nav">
        <button class="nav-btn active" data-tab="ideas">Ideas</button>
        <button class="nav-btn" data-tab="calendar">Calendar</button>
        <button class="nav-btn" data-tab="trending">Trending</button>
        <button class="nav-btn" data-tab="promote">Promote</button>
      </nav>
    </header>

    <main class="container">

      <!-- IDEAS TAB -->
      <section id="ideas-tab" class="tab-content active">
        <div class="tab-header ideas-tab-header">
          <div class="ideas-header-top">
            <h2>Ideas</h2>
            <button id="new-idea-btn" class="btn-primary">+ New Idea</button>
          </div>
          <div class="ideas-header-bottom">
            <div class="idea-counts">
              <span id="count-idea" class="count-chip chip-idea">0 just an idea</span>
              <span id="count-drafting" class="count-chip chip-drafting">0 drafting</span>
              <span id="count-ready" class="count-chip chip-ready">0 ready</span>
              <span id="count-published" class="count-chip chip-published">0 published</span>
            </div>
            <div class="filters-row">
              <select id="type-filter" class="filter-select">
                <option value="all">All Types</option>
                <option value="substack">Substack Article</option>
                <option value="tiktok">TikTok</option>
              </select>
              <input type="text" id="search-ideas" class="filter-search" placeholder="Search ideas...">
            </div>
          </div>
        </div>

        <div class="kanban-board">
          <div class="kanban-col">
            <div class="kanban-col-header">
              <span class="kanban-col-title">Just an Idea</span>
            </div>
            <div class="kanban-col-body" id="col-idea" data-status="idea"></div>
          </div>
          <div class="kanban-col">
            <div class="kanban-col-header">
              <span class="kanban-col-title">Drafting</span>
            </div>
            <div class="kanban-col-body" id="col-drafting" data-status="drafting"></div>
          </div>
          <div class="kanban-col">
            <div class="kanban-col-header">
              <span class="kanban-col-title">Ready</span>
            </div>
            <div class="kanban-col-body" id="col-ready" data-status="ready"></div>
          </div>
          <div class="kanban-col">
            <div class="kanban-col-header">
              <span class="kanban-col-title">Published</span>
            </div>
            <div class="kanban-col-body" id="col-published" data-status="published"></div>
          </div>
        </div>
      </section>

      <!-- CALENDAR TAB -->
      <section id="calendar-tab" class="tab-content">
        <div class="tab-header tab-header-row">
          <div style="display:flex;align-items:center;gap:0.5rem;">
            <button id="cal-prev" class="cal-nav-btn">‹</button>
            <h2 id="cal-month-title">Month Year</h2>
            <button id="cal-next" class="cal-nav-btn">›</button>
          </div>
          <button id="cal-today-btn" class="btn-secondary">Today</button>
        </div>

        <div class="calendar-grid" id="calendar-grid">
          <!-- populated by JS -->
        </div>

        <div class="cal-upcoming">
          <h3>Upcoming</h3>
          <div id="cal-upcoming-list" class="upcoming-list">
            <!-- populated by JS -->
          </div>
        </div>
      </section>

      <!-- TRENDING TAB -->
      <section id="trending-tab" class="tab-content">

        <!-- Reddit -->
        <div class="trending-section">
          <div class="trending-section-header">
            <div class="trending-section-left">
              <h2>What Grief Communities Are Talking About</h2>
              <p class="section-hint">Live posts from Reddit grief communities — updated each time you visit.</p>
            </div>
            <button id="reddit-refresh" class="btn-secondary">↻ Refresh</button>
          </div>

          <div class="reddit-subreddit-tabs">
            <button class="subreddit-tab active" data-sub="GriefSupport">r/GriefSupport</button>
            <button class="subreddit-tab" data-sub="grief">r/grief</button>
            <button class="subreddit-tab" data-sub="widowers">r/widowers</button>
          </div>

          <div id="reddit-posts" class="reddit-posts">
            <div class="reddit-loading">Loading posts...</div>
          </div>
        </div>


      </section>

      <!-- PROMOTE TAB -->
      <section id="promote-tab" class="tab-content">

        <!-- Events -->
        <div class="promote-section">
          <div class="promote-section-header">
            <div>
              <h2>Events</h2>
              <p class="section-hint">IRL or virtual event ideas to grow the Substack.</p>
            </div>
            <button class="btn-primary" data-promote-add="events">+ Add Event</button>
          </div>
          <div class="promote-list" id="promote-list-events"></div>
        </div>

        <!-- Cross-Post Opportunities -->
        <div class="promote-section">
          <div class="promote-section-header">
            <div>
              <h2>Cross-Post Opportunities</h2>
              <p class="section-hint">Grief writers on Substack to collaborate or cross-post with.</p>
            </div>
            <button class="btn-primary" data-promote-add="crossPosts">+ Add Writer</button>
          </div>
          <div class="promote-list" id="promote-list-crossPosts"></div>
        </div>

        <!-- Dream Collaborators -->
        <div class="promote-section">
          <div class="promote-section-header">
            <div>
              <h2>Dream Collaborators</h2>
              <p class="section-hint">People you'd love to feature — their mourning routine, their story.</p>
            </div>
            <button class="btn-primary" data-promote-add="collaborators">+ Add Person</button>
          </div>
          <div class="promote-list" id="promote-list-collaborators"></div>
        </div>

      </section>

    </main>
  </div>

  <!-- Idea Modal -->
  <div class="modal" id="idea-modal">
    <div class="modal-content">
      <button class="modal-close" id="modal-close-btn">&times;</button>

      <div class="modal-header">
        <input type="text" id="modal-title" class="modal-title-input" placeholder="What's the idea?">
      </div>

      <div class="modal-body">
        <div class="modal-row">
          <div class="modal-field">
            <label>Type</label>
            <select id="modal-type" class="modal-select">
              <option value="substack">Substack Article</option>
              <option value="tiktok">TikTok</option>
            </select>
          </div>
          <div class="modal-field">
            <label>Status</label>
            <select id="modal-status" class="modal-select">
              <option value="idea">Just an Idea</option>
              <option value="drafting">Drafting</option>
              <option value="ready">Ready</option>
              <option value="published">Published</option>
            </select>
          </div>
        </div>

        <div class="modal-row">
          <div class="modal-field">
            <label>Series <span class="field-hint">(optional)</span></label>
            <input type="text" id="modal-series" class="modal-input" placeholder="e.g. Grief Milestones">
          </div>
          <div class="modal-field">
            <label>Publish Date <span class="field-hint">(optional)</span></label>
            <input type="date" id="modal-date" class="modal-input">
          </div>
        </div>

        <div class="modal-field">
          <label>Notes</label>
          <textarea id="modal-notes" class="modal-textarea" placeholder="Angle, hook, personal connection, related pieces, research needed..."></textarea>
        </div>
      </div>

      <div class="modal-footer">
        <button id="modal-delete-btn" class="btn-delete" style="display:none;">Delete</button>
        <div class="modal-footer-right">
          <button id="modal-cancel-btn" class="btn-secondary">Cancel</button>
          <button id="modal-save-btn" class="btn-primary">Save Idea</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Calendar Day Modal -->
  <div class="modal" id="cal-modal">
    <div class="modal-content modal-content-sm">
      <button class="modal-close" id="cal-modal-close">&times;</button>
      <div class="modal-header">
        <h3 id="cal-modal-date-title">Date</h3>
      </div>
      <div class="modal-body">
        <p class="cal-modal-hint">Assign an idea to this date:</p>
        <select id="cal-modal-idea-select" class="modal-select">
          <option value="">— unscheduled ideas —</option>
        </select>
      </div>
      <div class="modal-footer">
        <div class="modal-footer-right">
          <button id="cal-modal-cancel" class="btn-secondary">Cancel</button>
          <button id="cal-modal-assign" class="btn-primary">Assign</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Promote Modal -->
  <div class="modal" id="promote-modal">
    <div class="modal-content modal-content-sm">
      <button class="modal-close" id="promote-modal-close">&times;</button>
      <div class="modal-header">
        <input type="text" id="promote-modal-title" class="modal-title-input" placeholder="Title / Name">
      </div>
      <div class="modal-body">
        <div class="modal-row">
          <div class="modal-field">
            <label>Status</label>
            <select id="promote-modal-status" class="modal-select"></select>
          </div>
          <div class="modal-field" id="promote-modal-date-wrap">
            <label>Date <span class="field-hint">(optional)</span></label>
            <input type="date" id="promote-modal-date" class="modal-input">
          </div>
        </div>
        <div class="modal-field" id="promote-modal-url-wrap">
          <label>Substack URL <span class="field-hint">(optional)</span></label>
          <input type="url" id="promote-modal-url" class="modal-input" placeholder="https://example.substack.com">
        </div>
        <div class="modal-field">
          <label>Notes</label>
          <textarea id="promote-modal-notes" class="modal-textarea" placeholder="Details, ideas, context..."></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button id="promote-modal-delete" class="btn-delete" style="display:none;">Delete</button>
        <div class="modal-footer-right">
          <button id="promote-modal-cancel" class="btn-secondary">Cancel</button>
          <button id="promote-modal-save" class="btn-primary">Save</button>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="firebase-config.js"></script>
  <script type="module" src="app.js"></script>
</body>
</html>
